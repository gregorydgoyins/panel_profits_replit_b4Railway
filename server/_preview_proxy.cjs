const e=require('express'),c=require('cors'),m=require('compression'),{createProxyMiddleware:p}=require('http-proxy-middleware');const VP=Number(process.env.VITE_PORT||5173),URL=process.env.VITE_DEV_URL||`http://127.0.0.1:${VP}`,PORT=Number(process.env.PORT||5000);const a=e();a.use(c());a.use(m());a.get('/__health',(_q,r)=>r.json({ok:true,port:PORT,vite:URL,time:new Date().toISOString()}));a.use('/',p({target:URL,changeOrigin:true,ws:true,secure:false}));a.listen(PORT,'0.0.0.0',()=>console.log(`✅ Preview proxy listening on ${PORT} → ${URL}`));